<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DFT RADIO</title>
  <link rel="icon" type="image/x-icon" href="assets/favicon.png">
  <style>
    body {
      margin: 0;
      background-color: black;
      height: 100vh;
      font-family: 'Arial Narrow', Arial, sans-serif;
      font-style: bold;
      overflow: hidden;
      cursor: none;
      color: white;
    }

    /* HORIZONTAL SCROLLER (manual, infinite loop) */
    .scroller {
      position: fixed;
      top: 50%;
      left: 0;
      width: 100%;
      height: auto;
      overflow-x: scroll;
      overflow-y: hidden;
      white-space: nowrap;
      transform: translateY(-50%);
      z-index: 1;
      scrollbar-width: none; /* Firefox */
    }

    .scroller::-webkit-scrollbar {
      display: none; /* Chrome/Safari */
    }

    .scroller-content {
      display: inline-block;
      white-space: nowrap;
      font-size: clamp(12px, 1.5vw, 20px); /* responsive font */
      text-transform: uppercase;
      letter-spacing: 0.15em;
      word-spacing: 0.6em;
      padding: 0 2vw;
    }

    /* Asterisk styling */
    .scroller-content span.asterisk {
      display: inline-block;
      transform: scale(3);
      transform-origin: center;
      line-height: 4;
      vertical-align: middle;
      color:#0f0;
    }

    /* Default state: hidden text */
    .scroller-content a {
      color: black;
      text-decoration: none;
      margin-right: 1.5em;
      transition: color 0.3s ease;
    }

    /* Show on hover */
    .scroller-content a:hover {
      color: white;
    }

    /* Toggle ON: show all text */
    .scroller-content.visible a {
      color: white;
    }

    /* Custom blinking green cursor */
    .cursor {
      position: fixed;
      left: 0;
      top: 0;
      width: 40px;
      height: 40px;
      background-color: rgba(0, 255, 0, 0.7);
      border-radius: 50%;
      pointer-events: none;
      transform: translate(-50%, -50%);
      z-index: 10001;
      animation: blink 1.5s step-start infinite;
    }

    @keyframes blink {
      50% { opacity: 0; }
    }

    .toggle-container {
      position: fixed;
      top: 1rem;
      right: 1rem;
      z-index: 10002;
      font-family: Helvetica, sans-serif;
      color: white;
      font-size: 0.95rem;
      user-select: none;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .switch {
      position: relative;
      display: inline-block;
      width: 60px;  /* larger for touch */
      height: 30px;
    }

    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0; left: 0;
      right: 0; bottom: 0;
      background-color: black;
      transition: 0.4s;
      border-radius: 34px;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 24px;  /* larger for touch */
      width: 24px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: 0.4s;
      border-radius: 50%;
    }

    input:checked + .slider {
      background-color: #0f0;
    }

    input:checked + .slider:before {
      transform: translateX(30px);
    }

    /* Small-screen adjustments */
    @media (max-width: 480px) {
      .scroller-content {
        padding: 0 4vw;
        letter-spacing: 0.1em;
        word-spacing: 0.4em;
      }
      .toggle-container {
        font-size: 1rem;
      }
    }
  </style>
</head>
<body>
  <!-- Toggle switch -->
  <div class="toggle-container">
    <label class="switch">
      <input type="checkbox" id="toggleText">
      <span class="slider"></span>
    </label>
  </div>

  <!-- Manual Scrolling Quote (looped) -->
  <div class="scroller" id="scroller">
    <div class="scroller-content" id="quoteLinePrev"></div>
    <div class="scroller-content" id="quoteLine"></div>
    <div class="scroller-content" id="quoteLineNext"></div>
  </div>

  <!-- Custom green cursor -->
  <div class="cursor" id="customCursor"></div>

  <!-- Audio placeholders -->
  <audio id="audioTL" loop autoplay muted></audio>
  <audio id="audioTR" loop autoplay muted></audio>
  <audio id="audioBL" loop autoplay muted></audio>
  <audio id="audioBR" loop autoplay muted></audio>

  <script>
    // CURSOR FOLLOW
    const cursor = document.getElementById('customCursor');
    document.addEventListener('mousemove', e => {
      cursor.style.left = e.clientX + 'px';
      cursor.style.top = e.clientY + 'px';
    });

    // RANDOM QUOTES
    const quoteSets = [
      ["A SIGNAL", "DOES NOT", "NECESSARILY MEAN THAT", "YOU", "WANT TO BE LOCATED", "OR DESCRIBED", "IT CAN MEAN THAT YOU WANT TO", "BE KNOWN AS UNLOCATABLE", "AND HIDDEN", " <span class='asterisk'>*</span>"],
      ["THE NAME OF A", "MAN", "IS", "A NUMBING BLOW", "FROM", "WHICH", "HE", "NEVER", "RECOVERS", " <span class='asterisk'>*</span>"],
      ["SO CLOSE THAT", "MY FEAR OF THEM", "AND THEIR FEAR OF ME", "BECAME ONE SAME FEAR", "AND THE HUNTER", "COULD NOT BE TOLD", "FROM THE HUNTED", "NOR THE EATER", "FROM THE FOOD", " <span class='asterisk'>*</span>"],
      ["A REPETITIVE FLURRY", "OF MULTI-TONAL UTTERANCESâ€”", "SQUEAKS AND CHIRPS", "IN QUICK SUCCESSION,", "NON-REVERBERANT", "WITH A SHORT RELEASE,", "MOVING ON ONE ANOTHER", "LIKE THE BEAT BELOW A CLUB MIX.", "(AND, OF COURSE, WHERE BETTER TO ECHOLOCATE THAN THE DARK, MUSTY CAVE OF A NIGHTCLUB?).", " <span class='asterisk'>*</span>"],
      ["THEY BOUNCE OFF NEARBY OBSTACLES.", "SITUATE THEMSELVES THREE DIMENSIONALLY THROUGH THEIR USE OF INFORMATION", "COLLECTED WITH TWO EARS,", "WHOLE BODY, AND THE DANK CAVE.", "THE BAT'S USE OF SOUND WAVES", "TO ILLUMINATE", "AN INVISIBLE SPACE", "IS THE PROCESS OF MANY SENSES AND BODILY ORGANS.", "THE EARS, MOUTH, AND NOSE WORK TOGETHER.", " <span class='asterisk'>*</span>"],
      ["AN OPENING","REALIZING","THAT A FLOODLIGHT","ISN'T", "ALWAYS","OR NECESSARILY","THE", "BEST WAY","TO ILLUMINATE IT", " <span class='asterisk'>*</span>"]
    ];

    const selected = quoteSets[Math.floor(Math.random() * quoteSets.length)];
    const buildLinks = arr => arr.map((text, i) =>
      text ? `<a href="${i + 1}.html" target="_blank" rel="noopener noreferrer">${text}</a>` : ""
    ).join(" ");

    const quoteLinePrev = document.getElementById('quoteLinePrev');
    const quoteLine = document.getElementById('quoteLine');
    const quoteLineNext = document.getElementById('quoteLineNext');

    // Build three copies for infinite scroll
    quoteLinePrev.innerHTML = buildLinks(selected);
    quoteLine.innerHTML = buildLinks(selected);
    quoteLineNext.innerHTML = buildLinks(selected);

    // Toggle: Show all text at once
    const toggle = document.getElementById('toggleText');
    toggle.addEventListener('change', () => {
      [quoteLinePrev, quoteLine, quoteLineNext].forEach(el => {
        if (toggle.checked) {
          el.classList.add('visible');
        } else {
          el.classList.remove('visible');
        }
      });
    });

    // Infinite scroll logic
    const scroller = document.getElementById('scroller');
    const resetScroll = () => {
      const middle = quoteLine.offsetLeft;
      scroller.scrollLeft = middle;
    };
    window.addEventListener('load', resetScroll);

    scroller.addEventListener('scroll', () => {
      const width = quoteLine.offsetWidth;
      const leftEdge = quoteLinePrev.offsetLeft;
      const rightEdge = quoteLineNext.offsetLeft;

      if (scroller.scrollLeft <= leftEdge) {
        scroller.scrollLeft += width;
      } else if (scroller.scrollLeft >= rightEdge) {
        scroller.scrollLeft -= width;
      }
    });

    // AUDIO SETUP
    const audioPool = [
      "assets/audio/salim-teo.mp3",
      "assets/audio/ko.m4a",
      "assets/audio/audio3.mp3",
      "assets/audio/audio4.mp3",
      "assets/audio/audio5.mp3",
      "assets/audio/audio6.mp3",
      "assets/audio/audio7.mp3",
      "assets/audio/audio8.mp3",
      "assets/audio/audio9.mp3"
    ];

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    const selectedAudio = shuffle([...audioPool]).slice(0, 4);

    const audioElements = {
      TL: document.getElementById('audioTL'),
      TR: document.getElementById('audioTR'),
      BL: document.getElementById('audioBL'),
      BR: document.getElementById('audioBR')
    };

    Object.keys(audioElements).forEach((corner, i) => {
      audioElements[corner].src = selectedAudio[i];
    });

    // Unmute on first mouse move
    window.addEventListener('mousemove', () => {
      Object.values(audioElements).forEach(audio => {
        audio.muted = false;
      });
    }, { once: true });

    // Volume based on cursor distance
    function getDistance(x1, y1, x2, y2) {
      return Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2);
    }

    function normalizeDistance(distance, maxDistance) {
      const volume = 1 - (distance / maxDistance);
      return Math.max(0, Math.min(1, volume));
    }

    document.addEventListener('mousemove', e => {
      const { innerWidth: w, innerHeight: h } = window;
      const coords = {
        TL: [0, 0],
        TR: [w, 0],
        BL: [0, h],
        BR: [w, h]
      };
      const maxDist = Math.sqrt(w ** 2 + h ** 2);

      for (const [corner, [cx, cy]] of Object.entries(coords)) {
        const dist = getDistance(e.clientX, e.clientY, cx, cy);
        const volume = normalizeDistance(dist, maxDist * 0.75);
        audioElements[corner].volume = volume;
      }
    });
  </script>
</body>
</html>
