<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DFT RADIO</title>
  <link rel="icon" type="image/x-icon" href="assets/favicon.png">
  <style>
    body {
      margin: 0;
      background-color: black;
      height: 100vh;
      font-family: 'Arial Narrow', Arial, sans-serif;
      font-style: bold;
      overflow: hidden;
      cursor: none;
      color: white;
    }

    /* horizontal scroll on infinite loop */
    .scroller {
      position: fixed;
      top: 50%;
      left: 0;
      width: 100%;
      height: auto;
      overflow-x: scroll;
      overflow-y: hidden;
      white-space: nowrap;
      transform: translateY(-50%);
      z-index: 1;
      scrollbar-width: none; /* Firefox */
    }

    .scroller::-webkit-scrollbar {
      display: none; 
    }

    .scroller-content {
      display: inline-block;
      white-space: nowrap;
      font-size: clamp(12px, 1.5vw, 20px); 
      text-transform: uppercase;
      letter-spacing: 0.15em;
      word-spacing: 0.6em;
      padding: 0 2vw;
    }

    /* Asterisk styling */
    .scroller-content span.asterisk {
      display: inline-block;
      transform: scale(3);
      transform-origin: center;
      line-height: 4;
      vertical-align: middle;
      color:#0f0;
    }

    /* hidden text */
    .scroller-content a {
      color: black;
      text-decoration: none;
      margin-right: 1.5em;
      transition: color 0.3s ease;
    }

    /* text visible on hover */
    .scroller-content a:hover {
      color: white;
    }

    /* toggle for visible text */
    .scroller-content.visible a {
      color: white;
    }

    /* green cursor */
    .cursor {
      position: fixed;
      left: 0;
      top: 0;
      width: 40px;
      height: 40px;
      background-color: rgba(0, 255, 0, 0.7);
      border-radius: 50%;
      pointer-events: none;
      transform: translate(-50%, -50%);
      z-index: 10001;
    }

/* press any key */
    #startOverlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  text-align: center;
  font-size: 1.5rem;
  padding: 1rem 0;
  z-index: 9999;
}

    .toggle-container {
      position: fixed;
      top: 1rem;
      right: 1rem;
      z-index: 10002;
      font-family: Helvetica, sans-serif;
      color: white;
      font-size: 0.95rem;
      user-select: none;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .switch {
      position: relative;
      display: inline-block;
      width: 60px;  
      height: 30px;
    }

    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0; left: 0;
      right: 0; bottom: 0;
      background-color: black;
      transition: 0.4s;
      border-radius: 34px;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 24px;  
      width: 24px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: 0.4s;
      border-radius: 50%;
    }

    input:checked + .slider {
      background-color: #0f0;
    }

    input:checked + .slider:before {
      transform: translateX(30px);
    }

    body.is-touch .cursor {
  display: none;
}

    @media (max-width: 480px) and (hover: none) and (pointer: coarse) {
      .scroller-content {
        padding: 0 4vw;
        letter-spacing: 0.1em;
        word-spacing: 0.4em;
        color: white;
      }
      .toggle-container {
        font-size: 1rem;
      }
  .cursor {
    display: none !important;
  }
      
    }
  </style>
</head>
<body>
  <!-- Toggle switch -->
  <div class="toggle-container">
    <label class="switch">
      <input type="checkbox" id="toggleText">
      <span class="slider"></span>
    </label>
  </div>

<div id="startOverlay">PRESS ANY KEY</div>

  <!-- Looped Scrolling Quote -->
  <div class="scroller" id="scroller">
    <div class="scroller-content" id="quoteLinePrev"></div>
    <div class="scroller-content" id="quoteLine"></div>
    <div class="scroller-content" id="quoteLineNext"></div>
  </div>

  <!-- green cursor -->
  <div class="cursor" id="customCursor"></div>

  <!-- Audio placeholders -->
  <audio id="audioTL" loop autoplay></audio>
  <audio id="audioTR" loop autoplay></audio>
  <audio id="audioBL" loop autoplay></audio>
  <audio id="audioBR" loop autoplay></audio>

  <script>
    // CURSOR FOLLOW
    const cursor = document.getElementById('customCursor');
    document.addEventListener('mousemove', e => {
      cursor.style.left = e.clientX + 'px';
      cursor.style.top = e.clientY + 'px';
    });

    const quoteSets = [
      ["A SIGNAL", "DOES NOT", "NECESSARILY MEAN THAT", "YOU", "WANT TO BE LOCATED", "OR DESCRIBED", "IT CAN MEAN THAT YOU WANT TO", "BE KNOWN AS UNLOCATABLE", "AND HIDDEN", " <span class='asterisk'>*</span>"],
      ["LOOK AT", "THE SKILL", "AND SPIRIT", "WITH WHICH", "I RISE", "FROM THAT", "WHICH RESEMBLES", "THE GRAVE", "BUT ISN'T!","<span class='asterisk'>*</span>"],
      ["THE NAME OF A", "MAN", "IS", "A NUMBING BLOW", "FROM", "WHICH", "HE", "NEVER", "RECOVERS", " <span class='asterisk'>*</span>"],
      ["SO CLOSE THAT", "MY FEAR OF THEM", "AND THEIR FEAR OF ME", "BECAME ONE SAME FEAR", "AND THE HUNTER", "COULD NOT BE TOLD", "FROM THE HUNTED", "NOR THE EATER", "FROM THE FOOD", " <span class='asterisk'>*</span>"],
      ["A REPETITIVE FLURRY", "OF MULTI-TONAL UTTERANCESâ€”", "SQUEAKS AND CHIRPS", "NON-REVERBERANT", "IN QUICK SUCCESSION,", "WITH A SHORT RELEASE,", "MOVING ON ONE ANOTHER", "LIKE THE BEAT BELOW A CLUB MIX.", "(AND, OF COURSE, WHERE BETTER TO ECHOLOCATE THAN THE DARK, MUSTY CAVE OF A NIGHTCLUB?).", " <span class='asterisk'>*</span>"],
      ["AN OPENING","REALIZING","THAT A FLOODLIGHT","ISN'T", "ALWAYS","OR NECESSARILY","THE", "BEST WAY","TO ILLUMINATE IT", " <span class='asterisk'>*</span>"]
    ];

    /* QUOTE ATTRIBUTIONS: 
    1. Fanny Howe, Bewilderment (1999)
    2. Ann Boyer, What Resembles the Grave but Isn't
    3. Marshall McLuhan
    4. Ursula K. LeGuin, She Unnames Them (1985)
    5. Charlotte Strange, Do Bats Fly Free on the Dark Web? (2019)
    7. Darby English, letter to Salim on the occasion of DFT 2025
    xoxoxo */

    const selected = quoteSets[Math.floor(Math.random() * quoteSets.length)];
    const buildLinks = arr => arr.map((text, i) =>
      text ? `<a href="${i + 1}.html">${text}</a>` : ""
    ).join(" ");

    const quoteLinePrev = document.getElementById('quoteLinePrev');
    const quoteLine = document.getElementById('quoteLine');
    const quoteLineNext = document.getElementById('quoteLineNext');

    // Build three copies for infinite scroll
    quoteLinePrev.innerHTML = buildLinks(selected);
    quoteLine.innerHTML = buildLinks(selected);
    quoteLineNext.innerHTML = buildLinks(selected);

    // Toggle: Show all text at once
    const toggle = document.getElementById('toggleText');
    toggle.addEventListener('change', () => {
      [quoteLinePrev, quoteLine, quoteLineNext].forEach(el => {
        if (toggle.checked) {
          el.classList.add('visible');
        } else {
          el.classList.remove('visible');
        }
      });
    });

    // Infinite scroll logic
    const scroller = document.getElementById('scroller');
    const resetScroll = () => {
      const middle = quoteLine.offsetLeft;
      scroller.scrollLeft = middle;
    };
    window.addEventListener('load', resetScroll);

    scroller.addEventListener('scroll', () => {
      const width = quoteLine.offsetWidth;
      const leftEdge = quoteLinePrev.offsetLeft;
      const rightEdge = quoteLineNext.offsetLeft;

      if (scroller.scrollLeft <= leftEdge) {
        scroller.scrollLeft += width;
      } else if (scroller.scrollLeft >= rightEdge) {
        scroller.scrollLeft -= width;
      }
    });

    // AUDIO SETUP
    const audioPool = [
      "assets/audio/salim-teo.mp3",
      "assets/audio/ko.mp3",
      "assets/audio/aili.mp3",
      "assets/audio/erica-kevin.mp3",
      "assets/audio/chris.m4a",
      "assets/audio/shani.m4a",
      "assets/audio/luisa.mp3",
      "assets/audio/ben.mp3",
      "assets/audio/secret.mp3"
    ];

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    const selectedAudio = shuffle([...audioPool]).slice(0, 4);

    const audioElements = {
      TL: document.getElementById('audioTL'),
      TR: document.getElementById('audioTR'),
      BL: document.getElementById('audioBL'),
      BR: document.getElementById('audioBR')
    };

    Object.keys(audioElements).forEach((corner, i) => {
      audioElements[corner].src = selectedAudio[i];
    });

  // Show "Press Any Key" message and wait for any interaction
const overlay = document.getElementById('startOverlay');

// Prevent autoplay on load
Object.values(audioElements).forEach(audio => {
  audio.muted = true;
  audio.pause();
});
function enableAudio() {
  Object.values(audioElements).forEach(audio => {
    audio.muted = false;
    audio.play().catch(err => {
      console.warn("Playback failed:", err);
    });
  });
}
function startAudioAndHideOverlay() {
  overlay.style.display = 'none';       // Hide the message
  enableAudio();                        // Start playing music
  removeEventListeners();               // Clean up
}

function removeEventListeners() {
  document.removeEventListener('keydown', startAudioAndHideOverlay);
  document.removeEventListener('click', startAudioAndHideOverlay);
  document.removeEventListener('touchstart', startAudioAndHideOverlay);
}

// Wait for any of these events to start
document.addEventListener('keydown', startAudioAndHideOverlay);
document.addEventListener('click', startAudioAndHideOverlay);
document.addEventListener('touchstart', startAudioAndHideOverlay);

    // Volume based on cursor distance
    function getDistance(x1, y1, x2, y2) {
      return Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2);
    }

    function normalizeDistance(distance, maxDistance) {
      const volume = 1 - (distance / maxDistance);
      return Math.max(0, Math.min(1, volume));
    }

    document.addEventListener('mousemove', e => {
      const { innerWidth: w, innerHeight: h } = window;
      const coords = {
        TL: [0, 0],
        TR: [w, 0],
        BL: [0, h],
        BR: [w, h]
      };
      const maxDist = Math.sqrt(w ** 2 + h ** 2);

      for (const [corner, [cx, cy]] of Object.entries(coords)) {
        const dist = getDistance(e.clientX, e.clientY, cx, cy);
        const volume = normalizeDistance(dist, maxDist * 0.75);
        audioElements[corner].volume = volume;
      }

    });
  </script>
  <script>if ('ontouchstart' in window || navigator.maxTouchPoints > 0) {
  document.body.classList.add('is-touch');
}</script>
</body>
</html>
